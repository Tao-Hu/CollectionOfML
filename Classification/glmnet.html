<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Comparison of classification methods for the homes data</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Comparison of classification methods for the homes data</h1>

<h2>Load the data</h2>

<h3>The response is whether the sample is from the west coast</h3>

<pre><code class="r"> load(&quot;S:\\Documents\\www\\BigData\\code\\homes.RData&quot;)

 s  &lt;- homes[,5:4]
 Y  &lt;- ifelse(homes[,3]==&quot;CA&quot; | homes[,3]==&quot;OR&quot; | homes[,3]==&quot;WA&quot;,1,0)
 n  &lt;- length(Y)

 library(maps)
 map(&quot;state&quot;)
 points(s,col=ifelse(Y==1,2,1))
 title(&quot;Class labels&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk data"/> </p>

<pre><code class="r"> X   &lt;- as.matrix(OTU)
 X   &lt;- ifelse(X&gt;0,1,0)
 vvv &lt;- apply(X,2,var)
 X   &lt;- X[,vvv&gt;0]          # Remove OTUs that are all 0 or all 1
</code></pre>

<h2>Split the data into training and testing</h2>

<pre><code class="r"> set.seed(0820)
 test   &lt;- rank(runif(n))&lt;= 0.2*n
 s1    &lt;- s[!test,]
 s2    &lt;- s[test,]

 Xo     &lt;- X[!test,]
 Yo     &lt;- Y[!test]
 Xp     &lt;- X[test,]
 Yp     &lt;- Y[test]
</code></pre>

<h2>K nearest neighbors</h2>

<pre><code class="r"> library(fields)
 dp      &lt;- rdist(Xp,Xo)
 rank    &lt;- apply(dp,1,rank)
 m       &lt;- rowSums(rank&lt;=5)
 p_knn10 &lt;- Yp
 p_knn20 &lt;- Yp
 p_knn30 &lt;- Yp
 for(i in 1:length(Yp)){
    rrr        &lt;- rank[i,]
    rrr        &lt;- ifelse(rrr==min(rrr),0,rrr) # Deal with ties
    p_knn10[i] &lt;- mean(Yo[rrr&lt;=10]) 
    p_knn20[i] &lt;- mean(Yo[rrr&lt;=20]) 
    p_knn30[i] &lt;- mean(Yo[rrr&lt;=30]) 
 }

 boxplot(p_knn10~Yp,xlab=&quot;Y_p&quot;,ylab=&quot;p_hat&quot;,main=&quot;KNN with K=10&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk KNN"/> </p>

<pre><code class="r"> boxplot(p_knn20~Yp,xlab=&quot;Y_p&quot;,ylab=&quot;p_hat&quot;,main=&quot;KNN with K=20&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk KNN"/> </p>

<pre><code class="r"> boxplot(p_knn30~Yp,xlab=&quot;Y_p&quot;,ylab=&quot;p_hat&quot;,main=&quot;KNN with K=30&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk KNN"/> </p>

<h2>Sure independence screening</h2>

<pre><code class="r"> r      &lt;- abs(cor(Yo,Xo))
 keep   &lt;- which(rank(-r) &lt;= 200)
 Xsubo  &lt;- Xo[,keep]
 Xsubp  &lt;- Xp[,keep]
</code></pre>

<h2>Fit the LASSO</h2>

<pre><code class="r"> library(glmnet)
 alpha  &lt;- 1.0
 cv     &lt;- cv.glmnet(Xsubo,Yo,family=&quot;binomial&quot;,alpha=alpha)
 plot(cv$lambda,cv$cvm)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk lasso"/> </p>

<pre><code class="r"> lambda &lt;- cv$lambda.min
 lambda
</code></pre>

<pre><code>## [1] 0.002876705
</code></pre>

<pre><code class="r"> lasso   &lt;- glmnet(Xsubo, Yo, family=&quot;binomial&quot;,alpha=alpha)
 best    &lt;- which.min(abs(lasso$lambda-lambda))
 p_lasso &lt;- predict(lasso,newx=Xsubp,type=&quot;response&quot;)[,best]

 boxplot(p_lasso~Yp,xlab=&quot;Y_p&quot;,ylab=&quot;p_hat&quot;,main=&quot;LASSO&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk lasso"/> </p>

<h2>Fit the elastic net</h2>

<pre><code class="r"> library(glmnet)
 alpha  &lt;- 0.5
 cv     &lt;- cv.glmnet(Xsubo,Yo,family=&quot;binomial&quot;,alpha=alpha)
 plot(cv$lambda,cv$cvm)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk EN"/> </p>

<pre><code class="r"> lambda &lt;- cv$lambda.min
 lambda
</code></pre>

<pre><code>## [1] 0.00361331
</code></pre>

<pre><code class="r"> lasso   &lt;- glmnet(Xsubo, Yo, family=&quot;binomial&quot;,alpha=alpha)
 best    &lt;- which.min(abs(lasso$lambda-lambda))
 p_EN    &lt;- predict(lasso,newx=Xsubp,type=&quot;response&quot;)[,best]

 boxplot(p_EN~Yp,xlab=&quot;Y_p&quot;,ylab=&quot;p_hat&quot;,main=&quot;EN&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk EN"/> </p>

<h2>Fit ridge regression</h2>

<pre><code class="r"> library(glmnet)
 alpha  &lt;- 0.0
 cv     &lt;- cv.glmnet(Xsubo,Yo,family=&quot;binomial&quot;,alpha=alpha)
 plot(cv$lambda,cv$cvm)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAgVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmZmZmtttmtv+QOgCQOjqQOmaQZpCQkDqQkGaQtpCQ29uQ2/+2ZgC2Zjq2///bkDrb25Db/7bb/9vb////tmb/25D//7b//9v///+509GCAAAACXBIWXMAAAsSAAALEgHS3X78AAAMEklEQVR4nO3dDXvayBWGYbnd2IkLcbvFXrdZWNOs+fr/P7CMULIGBIyY0Zwj3ue+unVbFxTnyegIBaRqA0mV9S8ANggvivCiCC+K8KIIL4rwoggvivCiCC+K8KIIL4rwoggvivCiCC+K8KIIL4rwoggvivCiCC+K8KIIL4rwoggvivCiCC+K8KIIL4rwoggvivCiCC+K8KIIL4rwoggvivCiCC+K8KIIL4rwoggvivCiCC+K8KIIL4rwoggvivCiCC+K8KIIL4rwoggvivCiCC8qJXwFz3oMn/BY9I3woggvivCiCC+K8KIILyo5/PKhup9X1d/erngs7KSGX79MN/P7bf/H986PhaHU8Kunt818tPva9bEwxIoXcXiSNseMHzHj3as2B0E4qtdAeFG9hf9wcBf5F38oKvuM7+ex6BvhReU4qg84qjfVfbAmv45/ntRfF594HW/n6NAt7iHXf/uvgzrO3FkyCM+KL+P8vtwg/GY1Zsbnca7tpbLlZ3xPj71hpxqdbXvFkr70y0j6dm+PvQEnAp9MSPjhaWt8KtV14a/Yl19A+HStyTqHz9/2LMJ31JKnU/jCfU8i/FlHldp6tjd2EvgUwp9znLR9dftu3Irwew4SRoYfIvXw+6UPs7ZkHuLqbiMe/qDsUehbyXxMMPzHmJfC3y698Htxj/btN7vCD4mE/xB0v7VO6QMa4T/GFtqdn6MXXneR77nh8Cd379jccnhW+Vk3F/5nYlb5WbcW/q/chD/rdsOzez/rVsL/qMw6j3Qj4T/s4VnnUYYevunMQu9q4OGrg38Q60bCs4fvaqjh2cUnGmh4VnqqoYfHlQYXfrfECZ9qaOF/VmcXn2ao4ZGI8KKGE/7HCzj28VkMJjxLPS/CixpE+LB7J3xeQwi/a85wz2o44ZEV4UWlhl+NR1c/NkJzgpa9fHbJ4Z/+U02ufOxlrPXepId/28zarmtJeN9yhK+va3rcnvCe5Ql/3WMvbDoMdqZ7X9we1bPY+0V4UbnCZ78LFeH75XPF1yfnGe99chme1d6/5PB93IWK8P1LDd/LPWkI379cr+Pz3oWK+d47fyue6EUkz/jcd6FiN1+Gu6N6wpdBeFG+wnPiphhX4Vnt5RBeFOFFuQrPfC/HUXiql+QnPPv5oggvivCi/IRnxhflJTzVC3MSnv18aYQXRXhRTsIz40tzEZ7q5XkIz37eAOFFEV6Uh/DMeAMuwqM8B+FZ7xbswzPhTRBeFOFF2YdnxpuwDk91I8bh2c9bIbwowotixouyDg8jtuFZ72ZMwzPh7RBeFOFFJYdfPkzWz1V1fJk7ZrxrqeHDBQ5nk23/x4yXNEX/UsOvnt7WL9PrLmnKejeUvKvfLvfFaLNZ3Hd+LBPeUvrB3ay+pOlxd8K7ZnhUT3hLli/nmPGGcoXPfjMi9MtyV88fDUN24RnxpjKcubvyRgWEN5XjzF3Q/dYkhDeV4czd3tcOj2XGW7Jb8TCVPOOvvRkR692W1VE9E94Y4UURXpTZCRxmvC3eVy/KbFfPgrdlFJ4Rb43woggvihkviqN6UTbhWe/mTMIz4e0RXhThRTHjRXFUL4rwomxmPHt6cxbhObZzgPCiCC+KGS+Ko3pRJrt6Frw9g/CMeA8IL4rwopjxojiqF2Wxq2fBO1A+PCPeBcKLIrwoZryouPCLU9e5SXhqmIoKv/o6zf/UMBUX/vgidtc/NXt6F+J29fNRtqfm2M6HyPAnZ3zYGYRL3UXfhYrwPqTO+G34ehAs/xH51IT3IXXGb79V33ks/lq2zHgXUmf8anz3+29v3HducOJW/Mnr1W7CZYyr+80i+lq2LHgfSp+5Y8Q7QXhRkbv6lldr+2LvQkV4JyJXfLjzTMvNJK94ama8Dx129W0HcAlPDVPJK77rXahY8T6kzviu96RhxjuRelTf9S5UhHci9o0Yk838ru2EPSt+oDr8Jc3yS9vBXde7UDHjfYgKv1vWLYs65alhKm5XXy/rjq/mTuzqWfA+FD5ly4j3gvCiYsIvP0/DG6xbj+o7PjXhvYgIHw7twnF9loM7ZrwTEeHnP/+6rdvhHYU9i1nxL9P6vVc5VjwL3ouoGf8Q3j09yzDjGfFulD2qJ7wbhBeV661XkU/NjPei+Fuv4EPht16x4r0ou+KZ8W6UnfGEd4OjelGpb73q+NTMeC+S33p19VPDVNm3XrHg3Sj61itGvB9FD+4I7wfhRRV+OceM96Lwmy3hBSteFDNeFOFFEV4UM14UR/Wiyu7qWfBulAzPiHeE8KIIL4oZL4rwotjViyK8qDzhW9+HSXjPUsM31zdse0ceM96z5BW/Gm+Tx614OJJhV78af/pfXHhWvB9ZZvzyoe2t18x4zziqF0V4UbnCR92FihnvR9EVT3c/CoZnT+9Jcvj4u1AR3pPU8B3uSUN4T5JP2Xa4CxUz3pGCK57wnmQ4V8+MHyKO6kURXhQncEQRXhS7elGEF0V4Ucx4USVXPN0dKReePb0rhBdFeFHMeFGseFGEF0V4Ucx4UYQXxa5eFOFFEV4UM14UK14U4UURXhQzXhThRbGrF0V4UYQXVTA8M96TYuFZ8L4QXhThRRWd8QlPhsxY8aIIL4rwopjxopLDLx+q0SziOneseF9Sw4crW87C7YgeL1zZkvC+pIYP17BdjCKuZdt+6wJYybHig8srnvCuJM/41TiUnzPjB4aXc6J4OScqV/iLd6FixfvCrl4U4UXlOHMXd4cKZrwruV7HX7wnDSvelxxn7j5+PflYwvtSbsVz5s6VDGfu4mY84X3hqF5UufCseFcIL4pdvShWvCjCi2JXL4rwongjhihWvCjCiyp5VE94R0qFr5jxvpQLz57elWLhOX/jC+FFEV4UM14UK14U4UURXhQzXhQrXhThRRFeFDNeFCteFOFFEV4U4UVxcCeKFS+K8KIIL4rwoji4E8WKF8WKF8WKF5UcfvlQ3U0vX9mSFe9MavhwZcv18+hyeFa8L6nhd8Fn96z4gcmx4rfmf//Cih+U5Bm/Go/Cl5bbULHiPeOoXhSv40XlCn/pLlSseGdY8aKY8aJynLmLuUMF4Z3J9Dr+4j1pCO9MnjN3EefqCe8LK15UhjN3zPgh4qheFOFFEV4U4UURXhThRRFeFOFFEV4U4UURXhThRRFeVKnw3H3MmWLh4QvhRRFeFOFFEV4U4UURXhThRRFeFOFFEV5Un+HhWX/h+3sqttz7lgkvumXCi26Z8KJbJrzolgkvumXCi26ZkzCiCC+K8KIIL4rwoggvivCiCC+K8KIILypX+NW4Or7Kcf/mVX2V3eJbX4absTVbLbvxessZfuxM4cM1ruf3eZ6ri9nEZOuL8NvebLXsxust5/ixM4UPV7NfHt+SsG/rl6nF1md337Zba7ZadOO7Lef4sTOFXz6+b1Zfp3meLF59SfWJwdbD73ez1cIbD1vO8WNnCh9uY2AQfvl5Gv74l996+O1vtlp44/UfuQw/9rBXfG02UVvxtcQfe9gzvjablN/60mjG74X3MOPDHeYNjurDzm7921v5rYff72arhTf+Y8ik/tjDfx1/NzXYuv3r+NQfmzN3oggvivCiCC+K8KIIL4rwoggvivCiCC+K8KIIL4rwoggvivCiCC+K8KIIL4rwoggvSjb8YvdhlNZ3J+8+mhaEj6fdJtXwy8+/v35/eiO8htW4uvv2+L5Zv3x7/PP1vflEzENY++uX/1bVaLsfGG3D/xr+l/D//uWfk+b7t0YqfFi/i1/+Nd0sH7+P/92EDx9C2n5ZP99vE9/XfxRmn97rL6PtQJg037f+tecmFX7Xbz4K/9rMwuJuiq6e3sJHj8M/oXPY1e8+odTs6sN/vDFa4R/f63//M3y+fP36fTypw8/C5SU+hv9jWn8m8UtzCYL6+9a/9ty0wtfrOwz498X9+vV9Ngq7+nF9cH+w4rdLvVnxzfetf+25SYUPO+5tw/l2H7/6uj2q/zrd/rfmA+d74ZtRX8/4Hx9IvzFS4euj+uku4+5YPVSdV+HgfS/8r/VnEtfP9VH97vvWv/TctMJ/tH41+HSvH7rhxRFeFOFFEV4U4UURXhThRRFeFOFFEV4U4UURXhThRRFeFOFFEV4U4UX9H3Lvp7iOgkiRAAAAAElFTkSuQmCC" alt="plot of chunk ridge"/> </p>

<pre><code class="r"> lambda &lt;- cv$lambda.min
 lambda
</code></pre>

<pre><code>## [1] 0.0172454
</code></pre>

<pre><code class="r"> lasso   &lt;- glmnet(Xsubo, Yo, family=&quot;binomial&quot;,alpha=alpha)
 best    &lt;- which.min(abs(lasso$lambda-lambda))
 p_ridge &lt;- predict(lasso,newx=Xsubp,type=&quot;response&quot;)[,best]

 boxplot(p_ridge~Yp,xlab=&quot;Y_p&quot;,ylab=&quot;p_hat&quot;,main=&quot;Ridge&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk ridge"/> </p>

<h2>Discriminant analysis</h2>

<pre><code class="r"> p0      &lt;- colMeans(Xsubo[Yo==0,])
 p1      &lt;- colMeans(Xsubo[Yo==1,])
 plot(p0,p1)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk DA"/> </p>

<pre><code class="r"> p_DA &lt;- Yp
 for(i in 1:length(Yp)){
    l0 &lt;- prod(dbinom(Xsubp[i,],1,p0))
    l1 &lt;- prod(dbinom(Xsubp[i,],1,p1))
    p_DA[i] &lt;- l1/(l0+l1)
 }

 boxplot(p_DA~Yp,xlab=&quot;Y_p&quot;,ylab=&quot;p_hat&quot;,main=&quot;DA&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk DA"/> </p>

<h2>Compare methods using Brier scores</h2>

<pre><code class="r"> names &lt;- c(&quot;KNN-10&quot;,&quot;KNN-20&quot;,&quot;KNN-30&quot;,&quot;LASSO&quot;,&quot;EN&quot;,&quot;RIDGE&quot;,&quot;DA&quot;)
 BS    &lt;- NULL
 BS[1] &lt;- mean((Yp-p_knn10)^2) # NN with K=10
 BS[2] &lt;- mean((Yp-p_knn20)^2) # NN with K=20
 BS[3] &lt;- mean((Yp-p_knn30)^2) # NN with K=30
 BS[4] &lt;- mean((Yp-p_lasso)^2) # glmnet - LASSO
 BS[5] &lt;- mean((Yp-p_EN)^2)    # glmnet - Elastic net
 BS[6] &lt;- mean((Yp-p_ridge)^2) # glmnet - ridge
 BS[7] &lt;- mean((Yp-p_DA)^2)    # DA

 names(BS)&lt;-names
 round(BS,3)
</code></pre>

<pre><code>## KNN-10 KNN-20 KNN-30  LASSO     EN  RIDGE     DA 
##  0.128  0.114  0.109  0.030  0.029  0.025  0.148
</code></pre>

<h2>Compare methods using classification accuracy</h2>

<pre><code class="r"> Yp1 &lt;- ifelse(p_knn10&gt;0.5,1,0)
 Yp2 &lt;- ifelse(p_knn20&gt;0.5,1,0)
 Yp3 &lt;- ifelse(p_knn30&gt;0.5,1,0)
 Yp4 &lt;- ifelse(p_lasso&gt;0.5,1,0)
 Yp5 &lt;- ifelse(p_EN&gt;0.5,1,0)
 Yp6 &lt;- ifelse(p_ridge&gt;0.5,1,0)
 Yp7 &lt;- ifelse(p_DA&gt;0.5,1,0)
 CA  &lt;- NULL
 CA[1] &lt;- mean(Yp==Yp1) # NN with K=10
 CA[2] &lt;- mean(Yp==Yp2) # NN with K=20
 CA[3] &lt;- mean(Yp==Yp3) # NN with K=30
 CA[4] &lt;- mean(Yp==Yp4) # glmnet - LASSO
 CA[5] &lt;- mean(Yp==Yp5) # glmnet - EN
 CA[6] &lt;- mean(Yp==Yp6) # glmnet - Ridge
 CA[7] &lt;- mean(Yp==Yp7) # DA

 names(CA)&lt;-names
 round(CA,3)
</code></pre>

<pre><code>## KNN-10 KNN-20 KNN-30  LASSO     EN  RIDGE     DA 
##  0.889  0.894  0.894  0.960  0.956  0.965  0.850
</code></pre>

<pre><code class="r"> #Confusion table for ridge
 table(Yp,Yp6)
</code></pre>

<pre><code>##    Yp6
## Yp    0   1
##   0 197   5
##   1   3  21
</code></pre>

<h2>Compare methods using classification accuracy</h2>

<pre><code class="r"> library(pROC)
 roc1 &lt;- roc(Yp,p_knn10)
 roc2 &lt;- roc(Yp,p_knn20)
 roc3 &lt;- roc(Yp,p_knn30)
 roc4 &lt;- roc(Yp,p_lasso)
 roc5 &lt;- roc(Yp,p_EN)
 roc6 &lt;- roc(Yp,p_ridge)
 roc7 &lt;- roc(Yp,p_DA)


 plot(roc1)
</code></pre>

<pre><code>## 
## Call:
## roc.default(response = Yp, predictor = p_knn10)
## 
## Data: p_knn10 in 202 controls (Yp 0) &gt; 24 cases (Yp 1).
## Area under the curve: 0.6043
</code></pre>

<pre><code class="r"> lines(roc2,col=2)
 lines(roc3,col=3)
 lines(roc4,col=4)
 lines(roc5,col=5)
 lines(roc6,col=6)
 lines(roc7,col=7)

 n1&lt;-paste(&quot;NN K=10 (AUC = &quot;,round(roc1$auc,3),&quot;)&quot;,sep=&quot;&quot;)
 n2&lt;-paste(&quot;NN K=20 (AUC = &quot;,round(roc2$auc,3),&quot;)&quot;,sep=&quot;&quot;)
 n3&lt;-paste(&quot;NN K=30 (AUC = &quot;,round(roc3$auc,3),&quot;)&quot;,sep=&quot;&quot;)
 n4&lt;-paste(&quot;LASSO (AUC = &quot;,round(roc4$auc,3),&quot;)&quot;,sep=&quot;&quot;)
 n5&lt;-paste(&quot;EN (AUC = &quot;,round(roc5$auc,3),&quot;)&quot;,sep=&quot;&quot;)
 n6&lt;-paste(&quot;Ridge (AUC = &quot;,round(roc6$auc,3),&quot;)&quot;,sep=&quot;&quot;)
 n7&lt;-paste(&quot;DA (AUC = &quot;,round(roc7$auc,3),&quot;)&quot;,sep=&quot;&quot;)

legend(&quot;bottomright&quot;,c(n1,n2,n3,n4,n5,n6,n7),lty=1,col=1:7,inset=0.05)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk ROC"/> </p>

<h2>Maps of test set prediction</h2>

<pre><code class="r">  map(&quot;state&quot;)
  title(&quot;Test set classifications - NN K=10&quot;)
  points(s2,pch=19,col=ifelse(p_knn10&gt;0.5,2,1))
  legend(&quot;bottomright&quot;,c(&quot;West coast&quot;,&quot;Not&quot;),col=2:1,pch=19)
</code></pre>

<p><img src="data:image/png;base64,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GONbOcy5DFVTaF0B8PcuZXzYp1u5y7wMVZR/PQnwdy+1/3DOtvKWfRmqKP8/Pwfwd6++/5w5wF9cAC9UAC9UzH+hlq6E2z53B11NAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9U/w8lNPYCf+U6WAAAAABJRU5ErkJggg==" alt="plot of chunk map"/> </p>

<pre><code class="r">  map(&quot;state&quot;)
  title(&quot;Test set classifications - NN K=20&quot;)
  points(s2,pch=19,col=ifelse(p_knn20&gt;0.5,2,1))
  legend(&quot;bottomright&quot;,c(&quot;West coast&quot;,&quot;Not&quot;),col=2:1,pch=19)
</code></pre>

<p><img src="data:image/png;base64,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lghjfCuHOZehagqtKwD+3qWMD/t0K3eZl6GK8q8nAf7upfYfztlW3rIvQxXl/+fnAP7u1fefMwf4iwvghQrghYr/j9QSlXDb5+6gqwnghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrgherfdx4zMiPlJoQAAAAASUVORK5CYII=" alt="plot of chunk map"/> </p>

<pre><code class="r">  map(&quot;state&quot;)
  title(&quot;Test set classifications - NN K=30&quot;)
  points(s2,pch=19,col=ifelse(p_knn30&gt;0.5,2,1))
  legend(&quot;bottomright&quot;,c(&quot;West coast&quot;,&quot;Not&quot;),col=2:1,pch=19)
</code></pre>

<p><img src="data:image/png;base64,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lseM01AtEcb4Vg5zTkPVFFpXAPzdpYwX+3Ard5mnoYryrycB/vZS+w/naCtv2aehivL/+TmAv736/jlzgL+4AF6oAF6o+H+klqiE2z5XB11NAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9U/wLnVjPbDc2cVQAAAABJRU5ErkJggg==" alt="plot of chunk map"/> </p>

<pre><code class="r">  map(&quot;state&quot;)
  title(&quot;Test set classifications - LASSO&quot;)
  points(s2,pch=19,col=ifelse(p_lasso&gt;0.5,2,1))
  legend(&quot;bottomright&quot;,c(&quot;West coast&quot;,&quot;Not&quot;),col=2:1,pch=19)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAhFBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OmY6OpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmZmZmtv+QOgCQOjqQOmaQtpCQ27aQ2/+2ZgC2Zjq2tma225C2/9u2///bkDrb/7bb/9vb////AAD/tmb/25D//7b//9v///+U6MJEAAAACXBIWXMAAAsSAAALEgHS3X78AAAZh0lEQVR4nO2dC3vcunGGcVzLTZPaaZvYaWolqdVYtsz///+6vOOOGdyI3fm+5xztihwAQ7zEYACu1mqCREpd7QB0jQBeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqABeqMYC/+uLWvTknnr+HCpknXn79O5byHQ59/OD+u1/vEa3mmKlLf388P774fbTVr9Sy0HjjdrtRtK9gH9WIfD2mSS6YFXhNrw6wd9upaXNhfLs/PHmdmbWb185FXfRWOCnoztfbt31eVp77t235YZ42s6rtZdXC+3M/PZ2ZgH/Y+vt3Xp7vZ3737nA+/+bjbYCm/Fa03rbzHV/nGt893ejvM/TxZU/b86+/74FlfXNFgqeBxzzg4J/XgbKx23ovP/ngXc78H23OMGv0eLdt7nDdyv3VQN/FtDaWLg9b2FnC0BPZ6uup0vL7/7x4Wk5ssWM/c1m8uvLeEN+TPDLj1t/fjs69/no0vXAYaGdWX/ZQ/38alhvx5YC68mztHXixunt0xIEPt7iwfvv5+C2PV3fPC2erDeK/ubHFoyYk0gPjQn+h9qmxmWozV25d91+4LA4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tezTUEX5v34O4B9efb/OHOAHF8ALFcALFf9LaolKNNvn6qDRBPBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBCBfBC9f8OuDqYcVdGZQAAAABJRU5ErkJggg==" alt="plot of chunk map"/> </p>

<pre><code class="r">  map(&quot;state&quot;)
  title(&quot;Test set classifications - Elastic net&quot;)
  points(s2,pch=19,col=ifelse(p_EN&gt;0.5,2,1))
  legend(&quot;bottomright&quot;,c(&quot;West coast&quot;,&quot;Not&quot;),col=2:1,pch=19)
</code></pre>

<p><img src="data:image/png;base64,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xsqGJeX7jQP/2GC39943f46jxJrAN3AAfH15wbsnYh4CD1isroDtVzPXXQ9V10Mlw1RwgGZcVGKhpox3ueSjaalWIiR3twp97xD9qhJVpPnPJZ/KqhWBhwZ/Du3eoyQHib/r2DfqtnVaTnLxrAA+T/6NcA75ZAClzfvrkwf4XPn+CJXR1zOskgOnWy499wD4fOXvkzX/fATAdxanIbdUetIJ8HWVuu7AjnrbNAC+vZJz9T6fggP47oqTvyiJ/NlIcehOYa9XdFum14deAf4ChS+t32ed7X1BgO+gwKV1/eope0eYDP7leZp+qvnHJ/PE2x++xUPuBnLBhx+K9MvAeRTgxj6P6N/a+fp0+/+/ntY3ugCeoK4bJt5YHPDG9/S+/fH7r7/+bf7xdXr/rD58mzuA28v2fj7223Hm7Xe1dA66gWjwvmru+rdM7rM/Kvj3f//2/pd//ve32+v08jS9fpqPzC9rg/715Xn6+fH77czt5/ufv86HDQOATx5pGt996Bt+rGCAv7X0tz/dRvrbj5nrfB/cXqa9J19/zqi3w7aBcPBXk2eBN7+Z+/X59daon25D/K3zVnO/fuvQf/u6g//j92llPI8F08vcyRsG0sEXPbCtEJ0F3tDPT3+/QfzT35fWfhz8+N3T4t8/P++4DwPx4As+olElujulIOzpzHr/z1uj/vXXf7tRXEfy238n13mMv71bz8yH3v71q2EA8OacuvufqafHmkBGv77MC/iX+cc6g9/6819f3Fn9q1L/8h/PpgHAm791v97cFl8/cJ+w4yj9fKxjeM8BgG+ki8EnyQN8I10OPrGHA/CNdDV456lQ+oFdpbAlpx9BXaqZkUH6gd00b78/T/oTmeSzmXhQ9ulH0PXgjahh8Prxt9+Xpy8AX6J0+2qegfF9GQHwxom3P/zj04p7Wasfz9wYMYtOP4QIPWvrBCzyxkmv1bwtt27EnrtzzKBFpx9EWo1eDz403bTBv//l+/aw9f3PXwE+V3ulXg8+uJwzxvgb6Nen28/tCRzAF2ip/mum9ZHv2gnM6hfef0OLr6X+j2nWsIH37q+bFtDL1B5j/F0rp8VP0+uHbVZ/PHPLiphxGqolwhjfKmDOaaiaQusKgH90KePFPtwqXOZpqKL860mAf3ip44dztFW07NNQRfm/fg7gH159v84c4AcXwAsVwAsV+ztqqUqE7XN10GgCeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKECeKH6fxxmrgN/c41EAAAAAElFTkSuQmCC" alt="plot of chunk map"/> </p>

<pre><code class="r">  map(&quot;state&quot;)
  title(&quot;Test set classifications - Ridge&quot;)
  points(s2,pch=19,col=ifelse(p_ridge&gt;0.5,2,1))
  legend(&quot;bottomright&quot;,c(&quot;West coast&quot;,&quot;Not&quot;),col=2:1,pch=19)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAilBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OmY6OpA6ZrY6kJA6kNtmAABmADpmAGZmOgBmOjpmOpBmZmZmtrZmtv+QOgCQOjqQOmaQtpCQ27aQ2/+2ZgC2Zjq2tma2/7a2/9u2///bkDrb/7bb/9vb////AAD/tmb/25D//7b//9v///+0MygQAAAACXBIWXMAAAsSAAALEgHS3X78AAAZbElEQVR4nO2diXocu3GFoZtIimOHchInlONIdiLGEkX1+79epnfsqMLWmKlzvns5w+5CoRp/o7D0DKUmSKTU1QFA1wjghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghQrghWo48L8+q0Uf3FNfn0OFrDNvn377FjJdzv38qN79t9fo5ilW2nG2xHqzPwq9fXr/nVj6Ut0R+K8qBN4+k0QXdBWuw6sNvNJYA3y+fn5c2u7l1qLPy69zn1puiA/b+aWT7Rbamfnt3v1eb0fffTmtt9fbuf+dC7z/v9loK7AZr57W22b2/TR7/O1vRnlDq+n882339p8z+Nub3/5nuQP2ixhO44L/uvSlp61Xvf/7gXc78H23OMGv2WKlsFu5rxr4s4BWx8Lw65Z2tgT04axVlwl+s33/fXnzDx/PEC9oxJSGBb/8uPW3b1v/P9PwfuCw0M6sv+ypfn41rLdjS4H15FnaOnFLFm+fliTwdMsH778fYejaU/2H09vLYnu82UMcTsOCf12b9N2XpXHnptvx7gcOi+PM69a39o54dOYlxWuzsJ3v69EZV2Pt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+7regK/VWNGwpHy/ceAfG+z23vvmz3GUWBP4Bg6Ary8vePdEzEPgAYuVCth+NXPd9VBtPVQwTAUHaMZFJRZqyniXSz4almolQnB3K20PxTzO8BBtIs1/LvlUVK0IPDT4c2j3HiU5SHyvY9+o29ZpOcHFowL4PPk3wjnkkxUobd5fnzzA58r3JVRGrmdYJQdOt1x67gHw+crfJ2v++QiA7yxOR26p9KQT4Osqdd2BHfW2YQB8eyXn6n0+BQfw3RUnf1EQ+bOR4qo7VXu9otsyvT70CvAXKHxp/T7rbO8LAnwHBS6t65+esneEyeC/Pk/Tq5p/fDBP/Pzdt3iVu4Fc8OGHIv0icB4FuHWfR/Q/4f7ydPv/P57WN7oAnqCuGybeujjgjX+04efvv//681/mH1+mt0/qt29zAri9bO/nY++OMz8/qiU56Aaiwfuauet3mdxnf1Twb//67e1Pf/+vb7fX6evT9PJhPjK/rB361+fn6fX999uZ28+3P36ZDxsGAJ880rR+96Fv+LGCAf7W03/+4TbS337MXOf74PYy7Zl8/Tmj3g7bBsLBX02eBd78Z1penl9unfrpNsTfkrea8/otob/7soP//fdpZTyPBdPXOckbBtLBFz2wrVA7C7yh1w9/vUH8w1+X3n4cfP/d0+PfPj3vuA8D8eALPqJRpXZ3SkHY05n19u+3Tv3rz/98o7iO5Lf/Tq7zGH97t56ZD/38py+GAcCbc+ruX1NPjzWBiH59nhfwX+cf6wx+y+e/Pruz+hel/vHfnk0DgDd/6369uT2+fsV9qh1H6edjHav3HAD4RroYfJI8wDfS5eATezgA30hXg3eeCqUf2FWqtuT0I6hLMzMiSD+wm+bt9+dJfyKTfDYTr5R9+hF0PXij1jB4/fjPj8vTF4AvUbp/NY/A+HsZAfDGiZ+/+9uHFfeyVj+euTHqLDr9ECJk1tYBWOSNk16reVtu3Yg9d+eYlRadfhBpLXo9+NB00wb/9qfv28PWtz9+Afhc7Y16Pfjgcs4Y42+gX55uP7cncABfoKX5r5nWR/7WTmBWv/D+C3p8LfV/TLNWG3jv/rppAb1M7THG37Vyevw0vfy2zeqPZ25ZNWachmqJMMa3qjDnNFRNoXUFwD+6lPFiH25VXeZpqKL860mAf3ip44dztFVt2aehivL/+TmAf3j1/XPmAD+4AF6oAF6o+H+klqhEtX2uDhpNAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9UAC9U/w9S27vawr9ofAAAAABJRU5ErkJggg==" alt="plot of chunk map"/> </p>

<pre><code class="r">  map(&quot;state&quot;)
  title(&quot;Test set classifications - DA&quot;)
  points(s2,pch=19,col=ifelse(p_DA&gt;0.5,2,1))
  legend(&quot;bottomright&quot;,c(&quot;West coast&quot;,&quot;Not&quot;),col=2:1,pch=19)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAH4CAMAAACR9g9NAAAAgVBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OmY6OpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmOpBmZmZmtv+QOgCQOjqQOmaQtpCQ27aQ2/+2ZgC2Zjq2tma225C2/9u2///bkDrb/7bb/9vb////AAD/tmb/25D//7b//9v///8e5mw8AAAACXBIWXMAAAsSAAALEgHS3X78AAAZdUlEQVR4nO2di5rcuHGFIUWSHVvrxLbkOBo70cQazYjv/4DhnbijCjeSXed8u9PdRAGoxk8ABZBsqQESKXW2A9A5AnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihAnihujL4X1/VrI9u0tOXUCYr5e23999DpnPa6yf17r+9RmNJsdxOYbOvX1bHPT5fS/cE/6RC4O2UJLpgUeE6vFrBq8/j+/FkIp8wZ+nK4IepCT/8GF+e1740tujYpPMJ8XFNV0sbLxZayvR2TJnB/xyPvvt2WK+vY9r/Thk+/N9ktGZYjZeSltPmeeH56+v7fxr5DS2mP9WS4a+8s+YE3QL809qXll714V873vXAj83iAL+MFu+/Tzw2K/dVA39k0OqYaT6tw846AH08atW1Di1P8+n3/n8+XX2svwP4+c/Ymt/X/n8Mw9uB3UJLWT5sQ/30alivx+YMS+KR20oYB4u33+ZB4PPYpT/82N3QtVb0POZ6/fRx9uXSugP4n8vs+e7b3NWmFt3wbgd2iz3l5zzZbjwmu7Uzz0O8OqaBje+WYTPWEqbOOwL99XU+A9YRYwU7jfrz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" alt="plot of chunk map"/> </p>

</body>

</html>
